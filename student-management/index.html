<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Registration Form</title>
    <link rel="stylesheet" href="./index.css">
</head>

<body>

    <div class="form-container">
        <h2>Student Registration Form</h2>
        <form id="studentForm">
            <label for="name">Full Name:</label>
            <input type="text" id="name" name="name" required placeholder="Enter your full name">

            <label for="email">Email Address:</label>
            <input type="email" id="email" name="email" required placeholder="Enter your email">

            <label for="dob">Date of Birth:</label>
            <input type="date" id="dob" name="dob" required>

            <label>Gender:</label>
            <label for="male">Male</label>
            <input type="radio" id="male" name="gender" value="Male" required>
            <label for="female">Female</label>
            <input type="radio" id="female" name="gender" value="Female">

            <label for="address">Address:</label>
            <textarea id="address" name="address" rows="4" required placeholder="Enter your address"></textarea>

            <button type="submit">Submit</button>
        </form>
    </div>

    <h2>Student Details Table</h2>
    <table id="detailsTable">
        <thead>
            <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Date of Birth</th>
                <th>Gender</th>
                <th>Address</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>

        </tbody>
    </table>

    <script>
        class Student {
            constructor(name, email, dob, gender, address) {
                this.name = name;
                this.email = email;
                this.dob = dob;
                this.gender = gender;
                this.address = address;
            }
        }

        let form = document.getElementById("studentForm")
        form.addEventListener("submit", (e) => {
            e.preventDefault();

            let name = document.getElementById("name").value;
            let email = document.getElementById("email").value;
            let dob = document.getElementById("dob").value;
            let gender = document.querySelector('input[name="gender"]:checked').value || '';
            let address = document.getElementById("address").value;

            let student = new Student(name, email, dob, gender, address)
            let table = document.getElementsByTagName("tbody")[0]
            let tableRow = document.querySelectorAll("#detailsTable tbody tr")
            let flag = false;
            tableRow.forEach((val) => {
                let existingEmail = val.cells[1].innerText;
                if (existingEmail == email) {
                    alert("email is already registered !")
                    flag = true;
                }

            })
            if(flag)return;

            let row = table.insertRow()

            row.insertCell(0).innerText = student.name;
            row.insertCell(1).innerText = student.email;
            row.insertCell(2).innerText = student.dob;
            row.insertCell(3).innerText = student.gender;
            row.insertCell(4).innerText = student.address;
            row.insertCell(5).innerHTML = `<button onclick="editStudent(this)">edit</button><button onclick="deleteRow(this)">delete</button>`;


            form.reset();
        })

        function editStudent(button) {
            let row = button.parentElement.parentElement;

            let name = row.cells[0].innerText
            let email = row.cells[1].innerText
            let dob = row.cells[2].innerText
            let gender = row.cells[3].innerText
            let address = row.cells[4].innerText

            document.getElementById("name").value = name
            document.getElementById("email").value = email
            document.getElementById("dob").value = dob
            document.querySelector(`input[name="gender"][value="${gender}"]`).checked = true;
            document.getElementById("address").value = address;

            row.remove()

        }

        function deleteRow(button) {
            let row = button.parentElement.parentElement;
            row.remove();
        }

    </script>

</body>

</html>